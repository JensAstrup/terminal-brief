{"version":3,"sources":["../src/index.ts"],"sourcesContent":["import { Dayjs, PluginFunc } from 'dayjs';\n\nconst BusinessDaysPlugin: PluginFunc<plugin.BusinessDaysPluginOptions> = (options = {}, dayjsClass, dayjsFactory) => {\n  const defaultWorkingWeekdays = [ 1, 2, 3, 4, 5 ];\n\n  dayjsFactory.getWorkingWeekdays = function(): number[] {\n    return options.workingWeekdays || defaultWorkingWeekdays;\n  };\n\n  dayjsFactory.setWorkingWeekdays = function(workingWeekdays: number[]): void {\n    options.workingWeekdays = workingWeekdays;\n  };\n\n  dayjsFactory.getHolidays = function(): string[] {\n    return options.holidays || [];\n  };\n\n  dayjsFactory.setHolidays = function(holidays: string[]): void {\n    options.holidays = holidays;\n  };\n\n  dayjsFactory.getHolidayFormat = function(): string | undefined {\n    return options.holidayFormat;\n  };\n\n  dayjsFactory.setHolidayFormat = function(holidayFormat: string): void {\n    options.holidayFormat = holidayFormat;\n  };\n\n  dayjsFactory.getAdditionalWorkingDays = function(): string[] {\n    return options.additionalWorkingDays || [];\n  };\n\n  dayjsFactory.setAdditionalWorkingDays = function(additionalWorkingDays: string[]): void {\n    options.additionalWorkingDays = additionalWorkingDays;\n  };\n\n  dayjsFactory.getAdditionalWorkingDayFormat = function(): string | undefined {\n    return options.additionalWorkingDayFormat;\n  };\n\n  dayjsFactory.setAdditionalWorkingDayFormat = function(additionalWorkingDayFormat: string): void {\n    options.additionalWorkingDayFormat = additionalWorkingDayFormat;\n  };\n\n  dayjsClass.prototype.isHoliday = function(this: Dayjs): boolean {\n    if (!options.holidays) { return false; }\n    if (options.holidays.includes(this.format(options.holidayFormat))) { return true; }\n\n    return false;\n  };\n\n  dayjsClass.prototype.isBusinessDay = function(this: Dayjs): boolean {\n    const workingWeekdays = options.workingWeekdays || defaultWorkingWeekdays;\n\n    if (this.isHoliday()) { return false; }\n    if (this.isAdditionalWorkingDay()) { return true; }\n    if (workingWeekdays.includes(this.day())) { return true; }\n\n    return false;\n  };\n\n  dayjsClass.prototype.isAdditionalWorkingDay = function(this: Dayjs): boolean {\n    if (!options.additionalWorkingDays) { return false; }\n    if (options.additionalWorkingDays.includes(this.format(options.additionalWorkingDayFormat))) { return true; }\n\n    return false;\n  };\n\n  dayjsClass.prototype.businessDaysAdd = function(this: Dayjs, days: number): Dayjs {\n    const numericDirection = days < 0 ? -1 : 1;\n    let currentDay = this.clone();\n    let daysRemaining = Math.abs(days);\n\n    while (daysRemaining > 0) {\n      currentDay = currentDay.add(numericDirection, `d`);\n\n      if (currentDay.isBusinessDay()) { daysRemaining -= 1; }\n    }\n\n    return currentDay;\n  };\n\n  dayjsClass.prototype.businessDaysSubtract = function(this: Dayjs, days: number): Dayjs {\n    let currentDay = this.clone();\n\n    currentDay = currentDay.businessDaysAdd(days * -1);\n\n    return currentDay;\n  };\n\n  dayjsClass.prototype.businessDiff = function(this: Dayjs, date: Dayjs): number {\n    const day1 = this.clone();\n    const day2 = date.clone();\n\n    const isPositiveDiff = day1 >= day2;\n    let start = isPositiveDiff ? day2 : day1;\n    const end = isPositiveDiff ? day1 : day2;\n\n    let daysBetween = 0;\n\n    if (start.isSame(end)) { return daysBetween; }\n\n    while (start < end) {\n      if (start.isBusinessDay()) { daysBetween += 1; }\n\n      start = start.add(1, `d`);\n    }\n\n    return isPositiveDiff ? daysBetween : -daysBetween;\n  };\n\n  dayjsClass.prototype.nextBusinessDay = function(this: Dayjs): Dayjs {\n    const searchLimit = 7;\n    let currentDay = this.clone();\n\n    let loopIndex = 1;\n    while (loopIndex < searchLimit) {\n      currentDay = currentDay.add(1, `day`);\n\n      if (currentDay.isBusinessDay()) { break; }\n      loopIndex += 1;\n    }\n\n    return currentDay;\n  };\n\n  dayjsClass.prototype.prevBusinessDay = function(this: Dayjs): Dayjs {\n    const searchLimit = 7;\n    let currentDay = this.clone();\n\n    let loopIndex = 1;\n    while (loopIndex < searchLimit) {\n      currentDay = currentDay.subtract(1, `day`);\n\n      if (currentDay.isBusinessDay()) { break; }\n      loopIndex += 1;\n    }\n\n    return currentDay;\n  };\n\n  dayjsClass.prototype.businessDaysInMonth = function(this: Dayjs): Dayjs[] {\n    if (!this.isValid()) { return []; }\n\n    let currentDay = this.clone().startOf(`month`);\n    const monthEnd = this.clone().endOf(`month`);\n    const businessDays: Dayjs[] = [];\n    let monthComplete = false;\n\n    while (!monthComplete) {\n      if (currentDay.isBusinessDay()) { businessDays.push(currentDay.clone()); }\n\n      currentDay = currentDay.add(1, `day`);\n\n      if (currentDay.isAfter(monthEnd)) { monthComplete = true; }\n    }\n\n    return businessDays;\n  };\n\n  dayjsClass.prototype.lastBusinessDayOfMonth = function(this: Dayjs): Dayjs {\n    const businessDays = this.businessDaysInMonth();\n    const lastBusinessDay = businessDays[businessDays.length - 1];\n    return lastBusinessDay;\n  };\n\n  dayjsClass.prototype.businessWeeksInMonth = function(this: Dayjs): Dayjs[][] {\n    if (!this.isValid()) { return []; }\n\n    let currentDay = this.clone().startOf(`month`);\n    const monthEnd = this.clone().endOf(`month`);\n    const businessWeeks: Dayjs[][] = [];\n    let businessDays: Dayjs[] = [];\n    let monthComplete = false;\n\n    while (!monthComplete) {\n      if (currentDay.isBusinessDay()) { businessDays.push(currentDay.clone()); }\n\n      if (currentDay.day() === 5 || currentDay.isSame(monthEnd, `day`)) {\n        businessWeeks.push(businessDays);\n        businessDays = [];\n      }\n\n      currentDay = currentDay.add(1, `day`);\n\n      if (currentDay.isAfter(monthEnd)) { monthComplete = true; }\n    }\n\n    return businessWeeks;\n  };\n};\n\nexport default BusinessDaysPlugin;\n"],"mappings":"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","names":["BusinessDaysPlugin","options","dayjsClass","dayjsFactory","defaultWorkingWeekdays","getWorkingWeekdays","workingWeekdays","setWorkingWeekdays","getHolidays","holidays","setHolidays","getHolidayFormat","holidayFormat","setHolidayFormat","getAdditionalWorkingDays","additionalWorkingDays","setAdditionalWorkingDays","getAdditionalWorkingDayFormat","additionalWorkingDayFormat","setAdditionalWorkingDayFormat","prototype","isHoliday","includes","format","isBusinessDay","isAdditionalWorkingDay","day","businessDaysAdd","days","numericDirection","currentDay","clone","daysRemaining","Math","abs","add","businessDaysSubtract","businessDiff","date","day1","day2","isPositiveDiff","start","end","daysBetween","isSame","nextBusinessDay","searchLimit","loopIndex","prevBusinessDay","subtract","businessDaysInMonth","isValid","startOf","monthEnd","endOf","businessDays","monthComplete","push","isAfter","lastBusinessDayOfMonth","lastBusinessDay","length","businessWeeksInMonth","businessWeeks"]}